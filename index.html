<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>FluffyMoko｜這裡有貓 預約系統</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-[#F5F5DC]"> <div id="root"></div>
    <script type="text/babel">
// 告訴網頁從 React 工具箱拿東西
const { useState, useMemo, useEffect, useCallback } = React;

// 修正截圖中提到的圖示問題，用貓掌代替原本會報錯的圖示
const Icon = () => <span style={{ marginRight: '8px' }}>🐾</span>;
const Calendar = Icon; const PawPrint = Icon; const Info = Icon; 
const User = Icon; const Clock = Icon; const ChevronRight = Icon;
const ChevronLeft = Icon; const AlertCircle = Icon; const MapPin = Icon;
const MessageCircle = Icon; const ClipboardCheck = Icon;
// --- 靜態資料定義 ---
const shopInfo = {
  name: "Fluffy Moko∥這裡有貓",
  slogan: "Where comfort meets quiet.",
  hours: "週二到週日 11:00am - 19:00pm",
  notice: "如有臨時公休會公告在Instagram",
  phone: "(02)8791-0208",
  address: "台北市內湖區內湖路二段263巷9弄5號",
  permit: "特寵業字第V1140432號",
  lineId: "@051yzbua"
};

const pricing = {
  standard: { normal: 750, holiday: 1100, maxTotal: 2, desc: "寬90 深100 高160", limit: "上限 2 隻" },
  vip: { normal: 950, holiday: 1300, maxTotal: 4, desc: "寬90 深100 高320", limit: "上限 4 隻" },
  extraCat: 200,
  food: {
    dryFood: 60,
    rawChicken: 70,
    rawBeef: 85
  }
};

// --- 子組件定義 (移出 App 以提升打字流暢度) ---

const Step1 = ({ onNext }) => (
  <div className="space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500 pb-10">
    <div className="bg-white p-6 md:p-8 rounded-[2.5rem] shadow-xl shadow-stone-200 border border-stone-100 overflow-hidden relative font-black">
      <div className="text-center mb-10">
        <h2 className="text-2xl font-black text-[#73634a] flex items-center justify-center gap-2">預約須知與入住規範</h2>
        <div className="h-1 w-12 bg-[#8c7851]/30 mx-auto mt-2 rounded-full" />
      </div>

      <div className="space-y-12">
        {/* 1. 基本門檻 */}
        <section className="space-y-4 text-left">
          <div className="flex items-center gap-2 text-[#73634a] font-black text-sm tracking-widest uppercase"><ShieldCheck size={20} className="text-[#8c7851]" /> 入住基本門檻</div>
          <div className="pl-7 space-y-4 font-black">
            <div className="flex items-start gap-4 bg-stone-50 p-4 rounded-3xl border border-stone-100">
              <CheckCircle2 className="text-green-600 mt-1 flex-shrink-0" size={18} />
              <p className="text-sm text-stone-700 font-black leading-relaxed">必須結紮：<span className="font-bold text-stone-500 block mt-1 text-xs">所有貓旅客須結紮才能入住，暫不接受尚未結紮的小朋友。</span></p>
            </div>
            <div className="flex items-start gap-4 bg-stone-50 p-4 rounded-3xl border border-stone-100">
              <Calendar className="text-[#8c7851] mt-1 flex-shrink-0" size={18} />
              <p className="text-sm text-stone-700 font-black leading-relaxed text-left">手冊核對：<span className="font-bold text-stone-500 block mt-1 text-xs">入住當天請務必攜帶並出示「一年內預防針註冊手冊」以供查核。</span></p>
            </div>
          </div>
        </section>

        {/* 2. 衛生規範 */}
        <section className="space-y-4 text-left font-black">
          <div className="flex items-center gap-2 text-amber-700 font-black text-sm tracking-widest uppercase font-black"><Sparkles size={20} /> 衛生與專業消毒</div>
          <div className="pl-7 space-y-4 text-left font-black">
            <div className="p-5 bg-amber-50/50 rounded-[2rem] border border-amber-100/50 space-y-3 shadow-sm font-black text-left">
              <p className="text-xs text-stone-600 font-black leading-relaxed">入住前一個月請先使用「除蚤、驅蟲口服或外用滴劑」並提供證明。</p>
              <p className="text-[11px] text-amber-800 font-black leading-relaxed">
                <span className="block mb-1 text-amber-900 font-black underline underline-offset-4 decoration-amber-300 font-black">本館定期外聘專業消毒費用單趟 $10,000 起</span>
                若入住後發現跳蚤或寄生蟲，飼主需全額承擔環境消毒與專業清潔費。
              </p>
            </div>
          </div>
        </section>

        {/* 3. 環境照顧 */}
        <section className="space-y-4 text-left font-black">
          <div className="flex items-center gap-2 text-[#8c7851] font-black text-sm tracking-widest uppercase font-black"><HeartPulse size={20} /> 環境適應與情緒照顧</div>
          <div className="pl-7 space-y-4 text-left font-black">
            <p className="text-[11px] text-stone-600 font-black leading-relaxed">多數貓咪到陌生環境容易緊張。本館提供專業輔助協助主子放鬆警戒：</p>
            <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
              <div className="flex items-center gap-3 bg-stone-50 p-3 rounded-2xl border border-stone-100 font-black">
                <div className="w-8 h-8 rounded-full bg-white flex items-center justify-center text-[#8c7851] shadow-sm flex-shrink-0 font-black"><Volume2 size={16}/></div>
                <span className="text-xs font-black text-stone-600">投放低音頻貓音樂</span>
              </div>
              <div className="flex items-center gap-3 bg-stone-50 p-3 rounded-2xl border border-stone-100 font-black">
                <div className="w-8 h-8 rounded-full bg-white flex items-center justify-center text-[#8c7851] shadow-sm flex-shrink-0 font-black"><Sparkles size={16}/></div>
                <span className="text-xs font-black text-stone-600 font-black">24h 插電式情緒放鬆商品</span>
              </div>
            </div>
            <div className="p-4 bg-stone-50 rounded-2xl border border-stone-100 font-black">
              <p className="text-[11px] text-stone-500 font-black leading-relaxed font-black">※ 館內備有舒緩噴霧。如貓咪仍強烈不適應、情緒激動或引發明顯生理問題，本館會立即通知飼主帶回以確保安全。</p>
            </div>
          </div>
        </section>

        {/* 4. 誠實告知義務 */}
        <section className="space-y-4 text-left font-black">
          <div className="flex items-center gap-2 text-[#73634a] font-black text-sm tracking-widest uppercase font-black"><ClipboardCheck size={20} /> 誠實告知義務與責任</div>
          <div className="pl-7 space-y-4">
            <div className="p-5 bg-[#8c7851]/5 rounded-[2rem] border border-[#8c7851]/10 space-y-3 text-left font-black">
              <p className="text-xs text-stone-700 font-black">請誠實告知：貓咪重大疾病、詳細個性、或特殊注意事項。</p>
              <div className="p-3 bg-white/60 rounded-xl border border-[#8c7851]/10 text-left font-black">
                 <p className="text-[11px] text-[#73634a] font-black leading-relaxed font-black">
                   ⚠️ 因隱瞞貓咪真實狀況導致其他損失，飼主需承擔全額賠償責任（如：工作人員受傷、館內設備受損、其他旅客受影響等）。
                 </p>
              </div>
            </div>
          </div>
        </section>

        {/* 5. 謝絕入住狀況說明 */}
        <section className="space-y-4 text-left font-black">
          <div className="flex items-center gap-2 text-red-600 font-black text-sm tracking-widest uppercase font-black"><Ban size={20} /> 謝絕入住狀況說明</div>
          <div className="pl-7 grid grid-cols-1 gap-4 text-left font-black">
            <div className="bg-red-50/40 p-5 rounded-[2.5rem] border border-red-100 space-y-4 shadow-sm text-left font-black">
              <div className="flex items-center gap-2 text-red-800 font-black text-[10px] uppercase tracking-[0.2em] font-black">
                 <AlertCircle size={14} /> 傳染性疾病與健康紅線
              </div>
              <div className="grid grid-cols-1 gap-3 text-[11px] text-stone-600 font-black leading-relaxed text-left font-black">
                <div className="pb-3 border-b border-red-100/50">
                  <strong className="text-red-700 block mb-1 font-black text-xs font-black">● 呼吸道及結膜感染：</strong>
                  包含「皰疹病毒 (FHV-1)」、「卡西里病毒 (FCV)」。若有頻繁噴嚏、流鼻涕、口內潰瘍、眼分泌物異常及細菌性結膜炎等症狀恕無法接待。
                </div>
                <div className="pb-3 border-b border-red-100/50">
                  <strong className="text-red-700 block mb-1 font-black text-xs font-black">● 免疫與重大疾病：</strong>
                  包含「貓愛滋 (FIV)」、「腹膜炎 (FIP)」、「貓瘟」。以上病史或檢驗陽性者，本館恕不接待以維護環境安全。
                </div>
                <div className="font-black">
                  <strong className="text-red-700 block mb-1 font-black text-xs font-black font-black">● 行為與生理限制：</strong>
                  皮膚病、耳疥蟲、跳蚤、感染性腸炎；具強烈攻擊性；術後傷口未拆線癒合；即便結紮仍會噴尿佔地盤之行為；以及高齡導致器官衰竭風險極高者。
                </div>
              </div>
            </div>
          </div>
        </section>

        {/* 6. 醫療行為與營業規範 */}
        <section className="space-y-4 text-left font-black">
          <div className="flex items-center gap-2 text-rose-800 font-black text-sm tracking-widest uppercase font-black">
            <Stethoscope size={20} /> 醫療行為與營業規範
          </div>
          <div className="pl-7 space-y-5">
            <div className="p-6 bg-rose-600 rounded-[2.5rem] text-white shadow-xl shadow-rose-100 overflow-hidden relative text-left font-black">
              <div className="relative z-10 space-y-4 font-black">
                <h4 className="font-black text-sm mb-3 flex items-center gap-2 font-black">
                  <Ban size={18} /> 本店<span className="text-amber-300 underline decoration-amber-300/30 underline-offset-4 font-black">絕對無法</span>提供任何醫療輔助
                </h4>
                <div className="text-[11px] leading-relaxed font-black border-l-2 border-white/30 pl-4 space-y-3 font-black">
                  <p>
                    由於本館非法定醫療機構，<span className="text-amber-200 font-black">依法禁止</span>執行任何涉及醫療照顧之項目，包含：<span className="text-amber-200 underline underline-offset-4 px-1 text-xs font-black">打針、餵藥、點藥、擦藥、擠尿、更換敷料、傷口護理</span> 等。
                  </p>
                  <p className="bg-black/10 p-3 rounded-2xl border border-white/10 font-black font-black">
                    根據相關法律，非獸醫人員執行醫療行為屬<span className="text-amber-200 font-black">違法</span>。請家長務必誠實告知現況。
                  </p>
                </div>
              </div>
              <div className="absolute -right-6 -bottom-6 opacity-10 rotate-12 transition-transform font-black font-black">
                 <ShieldAlert size={140} />
              </div>
            </div>

            <div className="p-5 bg-stone-100 rounded-[2.25rem] border border-stone-200 space-y-4 shadow-sm text-left font-black font-black font-black">
              <div className="flex items-center gap-2 text-stone-500 font-black text-[10px] uppercase tracking-[0.2em] font-black">
                 <Clock size={16} /> 營業時間與人員安全留守
              </div>
              <p className="text-[11px] text-stone-500 font-black leading-relaxed px-1 text-left font-black font-black">
                ● 本館營業至 19:00。營業時間結束後，現場將由雲端監控取代，<span className="text-[#73634a] font-black underline decoration-stone-300 underline-offset-4 font-black">不會有人員在場留守</span>。<br/>
                ● 家長需於預約前審慎評估貓咪是否適合半夜無人在場陪伴。若需 24 小時專人巡房者，請另尋專業住所。
              </p>
            </div>
          </div>
        </section>
      </div>
    </div>
    <button onClick={onNext} className="w-full py-6 bg-[#73634a] text-white rounded-3xl font-black shadow-xl hover:bg-[#5d503c] transition-all flex items-center justify-center gap-3 active:scale-95 group shadow-[#73634a]/20 font-black">
      我已詳閱並同意以上入住規範 
      <ArrowRight size={20} className="group-hover:translate-x-1 transition-transform font-black font-black" />
    </button>
  </div>
);

const Step2 = ({ formData, setFormData, onNext, onBack, calculateTotal, loadMockHistory }) => {
  const maxCats = pricing[formData.roomType].maxTotal;
  const maxExtra = maxCats - 1;

  const adjustExtraCats = (val) => {
    const newVal = Math.min(Math.max(0, formData.extraCats + val), maxExtra);
    setFormData({ ...formData, extraCats: newVal });
  };

  return (
    <div className="space-y-6 animate-in fade-in duration-500 pb-10 font-black">
      <div className="bg-white p-6 md:p-8 rounded-[2.5rem] shadow-xl shadow-stone-200 border border-stone-100 space-y-10 font-black font-black">
        <div className="flex justify-between items-center px-1">
          <h2 className="text-xl font-black text-[#73634a] flex items-center gap-2 font-black text-left font-black font-black font-black font-black"><User size={24} /> 預約基礎資料</h2>
          <button onClick={loadMockHistory} className="text-[10px] bg-[#8c7851]/5 px-4 py-2 rounded-2xl text-[#8c7851] font-black border border-[#8c7851]/10 hover:bg-[#8c7851]/10 transition-colors flex items-center gap-1.5 font-black font-black font-black font-black font-black font-black font-black font-black"><History size={14}/>回訪代入</button>
        </div>

        <div className="grid grid-cols-2 gap-4 px-1 text-left font-black font-black font-black font-black">
          <div className="space-y-1">
            <label className="text-[10px] font-black text-stone-400 px-1 uppercase tracking-widest font-black font-black font-black font-black">Parent Name</label>
            <input 
              type="text" className="w-full p-4 rounded-2xl border-2 border-stone-100 bg-stone-50 font-bold text-sm outline-none focus:bg-white focus:border-[#8c7851] transition-all font-black font-black font-black font-black font-black" 
              placeholder="家長姓名" value={formData.parentName} onChange={e => setFormData({...formData, parentName: e.target.value})} 
            />
          </div>
          <div className="space-y-1 text-left font-black font-black font-black font-black font-black">
            <label className="text-[10px] font-black text-stone-400 px-1 uppercase tracking-widest font-black font-black font-black font-black font-black font-black">Cat Name</label>
            <input 
              type="text" className="w-full p-4 rounded-2xl border-2 border-stone-100 bg-stone-50 font-bold text-sm outline-none focus:bg-white focus:border-[#8c7851] transition-all font-black font-black font-black font-black font-black font-black" 
              placeholder="貓咪姓名" value={formData.catName} onChange={e => setFormData({...formData, catName: e.target.value})} 
            />
          </div>
          <div className="col-span-2 space-y-1 text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black">
            <label className="text-[10px] font-black text-stone-400 px-1 uppercase tracking-widest font-black font-black font-black font-black font-black font-black font-black font-black">Contact Phone</label>
            <input 
              type="tel" className="w-full p-4 rounded-2xl border-2 border-stone-100 bg-stone-50 font-bold text-sm outline-none focus:bg-white focus:border-[#8c7851] transition-all font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black" 
              placeholder="聯絡電話" value={formData.phone} onChange={e => setFormData({...formData, phone: e.target.value})} 
            />
          </div>
          <div className="col-span-2 space-y-1 text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
            <label className="text-[10px] font-black text-[#8c7851] px-1 uppercase tracking-widest flex items-center gap-1.5 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
              <MessageSquare size={12} /> 貓咪資料備註
            </label>
            <textarea 
              className="w-full p-4 rounded-2xl border-2 border-stone-100 bg-stone-50 font-bold text-sm outline-none focus:bg-white focus:border-[#8c7851] min-h-[100px] resize-none transition-all font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black"
              placeholder="請描述貓咪個性或特殊需求..."
              value={formData.catRemarks}
              onChange={e => setFormData({...formData, catRemarks: e.target.value})}
            ></textarea>
            <p className="text-[10px] text-stone-400 font-bold px-1 leading-relaxed font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
              ※ 如兩隻以上貓咪入住，請由一位代表填寫或詳細註明各別狀況。
            </p>
          </div>
        </div>

        <div className="space-y-4 pt-4 border-t border-stone-50 px-1 text-left font-black">
          <h3 className="text-[10px] font-black text-stone-400 px-1 uppercase tracking-[0.2em] text-center font-black">Room Selection</h3>
          <div className="grid grid-cols-1 gap-4 font-black">
            {Object.entries(pricing).filter(([k]) => k !== 'extraCat' && k !== 'food').map(([k, r]) => (
              <div 
                key={k} onClick={() => setFormData({...formData, roomType: k})}
                className={`p-6 rounded-[2rem] border-2 cursor-pointer transition-all duration-300 relative group overflow-hidden font-black ${formData.roomType === k ? 'border-[#8c7851] bg-[#73634a] text-white shadow-lg translate-y-[-2px]' : 'border-stone-100 bg-white hover:border-stone-200'}`}
              >
                <div className="flex justify-between items-center relative z-10 text-left font-black">
                  <div>
                    <div className="flex items-center gap-2 mb-1 font-black">
                      <span className="text-base font-black tracking-tight font-black">{k === 'standard' ? 'Standard 普通房' : 'VIP 旗艦房'}</span>
                      <span className={`text-[9px] px-2 py-0.5 rounded-full font-black ${formData.roomType === k ? 'bg-white/20 text-white' : 'bg-stone-100 text-stone-400'}`}>{r.limit}</span>
                    </div>
                    <p className={`text-[10px] font-black ${formData.roomType === k ? 'text-white/60' : 'text-stone-400'}`}>{r.desc}</p>
                  </div>
                  <div className="text-right font-black">
                    <p className="text-xl font-black tracking-tighter font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">${formData.isHoliday ? r.holiday : r.normal}</p>
                    <p className={`text-[9px] font-black uppercase ${formData.roomType === k ? 'text-white/40' : 'text-stone-300'}`}>{formData.isHoliday ? 'Holiday Rate' : 'Normal Rate'}</p>
                  </div>
                </div>
                {formData.roomType === k && <div className="absolute right-0 top-0 p-1 opacity-10 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black"><PawPrint size={60} /></div>}
              </div>
            ))}
          </div>
        </div>

        {/* 計價說明 - 裝飾線完全靠左 */}
        <div className="p-6 bg-stone-50 rounded-[2.5rem] border border-stone-100 space-y-5 shadow-inner text-left font-black">
          <div className="flex items-center justify-between">
            <div>
              <span className="text-sm font-black text-stone-700 block tracking-wider font-black">計價模式切換</span>
              <span className="text-[9px] text-stone-400 font-bold uppercase tracking-widest font-black font-black">Holiday Strategy</span>
            </div>
            <button 
              onClick={() => setFormData({...formData, isHoliday: !formData.isHoliday})}
              className={`w-14 h-8 rounded-full transition-all relative ${formData.isHoliday ? 'bg-red-500 shadow-inner' : 'bg-stone-200'}`}
            >
              <div className={`absolute top-1.5 w-5 h-5 bg-white rounded-full shadow-md transition-all ${formData.isHoliday ? 'left-7.5' : 'left-1.5'}`} />
            </button>
          </div>
          
          <div className="bg-white/80 p-5 rounded-[2rem] border border-stone-100 space-y-4 shadow-sm text-left font-black font-black font-black">
            <div className="flex items-start gap-4">
               <div className="w-10 h-10 rounded-2xl bg-red-50 flex items-center justify-center text-red-500 flex-shrink-0 font-black font-black font-black font-black">
                  <Calendar size={20} />
               </div>
               <div className="space-y-3 font-black font-black font-black font-black font-black">
                  <p className="text-[11px] text-stone-700 font-black leading-relaxed text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
                    國定假日與連假定義依「行政院人事行政總處行事曆」紅字為準。
                  </p>
                  <div className="p-3 bg-red-50/50 rounded-2xl border border-red-100/30 text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black">
                     <p className="text-[10px] font-black text-red-800 flex items-center gap-1.5 leading-relaxed font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
                        <AlertCircle size={14} /> 例：端午、中秋、年假及其彈性放假、補假等連假。
                     </p>
                  </div>
                  <p className="text-[11px] text-stone-500 font-black leading-relaxed border-l-2 border-stone-200 pl-4 -ml-12 text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black">
                     ● 凡具連續的紅字假日即為國定假日價格。<br/>
                     ● 一般六、日若非處於連假期間，則視為平日價格。
                  </p>
               </div>
            </div>
          </div>
        </div>

        <div className="space-y-6 pt-2 text-left font-black">
          <div className="flex justify-between items-center px-1 text-left font-black">
            <span className="text-sm font-black text-stone-700 flex items-center gap-2 font-black">
              <PawPrint size={18} className="text-[#8c7851]" /> 同房住宿貓數 
              <span className="text-[10px] text-[#8c7851] bg-[#8c7851]/10 px-2 py-0.5 rounded-full font-black font-black">+$200/隻</span>
            </span>
            <span className="text-2xl font-black italic text-[#73634a] font-black">{formData.extraCats + 1} <span className="text-xs tracking-widest uppercase opacity-40 font-black">Cats</span></span>
          </div>
          <div className="px-1 font-black">
            <div className="flex items-center justify-between bg-stone-100 rounded-3xl p-1 border border-stone-200 shadow-inner w-full overflow-hidden font-black">
              <button 
                onClick={() => adjustExtraCats(-1)}
                disabled={formData.extraCats === 0}
                className="w-14 h-14 flex items-center justify-center rounded-2xl bg-white text-[#73634a] shadow-sm active:scale-90 disabled:opacity-20 transition-all border border-stone-200/50 font-black font-black font-black"
              >
                <Minus size={20} />
              </button>
              <div className="flex flex-col items-center font-black font-black font-black font-black">
                 <span className="text-xl font-black text-[#73634a] leading-none font-black font-black font-black">{formData.extraCats + 1}</span>
                 <span className="text-[7px] font-black uppercase text-stone-400 mt-1 font-black">Total Stay</span>
              </div>
              <button 
                onClick={() => adjustExtraCats(1)}
                disabled={formData.extraCats >= maxExtra}
                className="w-14 h-14 flex items-center justify-center rounded-2xl bg-[#73634a] text-white shadow-md active:scale-90 disabled:bg-stone-300 transition-all font-black font-black font-black font-black font-black"
              >
                <Plus size={20} />
              </button>
            </div>
          </div>
        </div>
      </div>

      {/* 房價格 - 與上方框框同寬 */}
      <div className="p-4 bg-[#73634a] text-white rounded-[1.5rem] shadow-xl relative overflow-hidden flex items-center justify-center gap-4 w-full font-black font-black">
        <div className="opacity-10 rotate-12 transition-transform font-black font-black font-black font-black font-black"><ShoppingBag size={32} /></div>
        <div className="relative z-10 flex flex-col items-center font-black font-black font-black font-black">
          <p className="text-[9px] font-black tracking-[0.3em] uppercase opacity-50 mb-1.5 font-black font-black font-black font-black font-black font-black">Estimated Daily Rate</p>
          <div className="flex items-end gap-1 leading-none font-black font-black font-black font-black font-black font-black font-black">
            <span className="text-sm font-bold opacity-80 mb-0.5 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">$</span>
            <span className="text-3xl font-black tracking-tighter font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">{calculateTotal}</span>
          </div>
        </div>
      </div>

      <div className="flex gap-4 font-black font-black font-black font-black font-black font-black font-black">
        <button onClick={onBack} className="flex-1 py-5 bg-white text-stone-400 rounded-3xl font-black border border-stone-100 transition-all hover:bg-stone-50 active:scale-95 font-black">返回</button>
        <button onClick={onNext} className="flex-[2.5] py-5 bg-[#73634a] text-white rounded-3xl font-black shadow-xl hover:bg-[#5d503c] transition-all active:scale-95 flex items-center justify-center gap-2 font-black">下一步 <ChevronRight size={20} /></button>
      </div>
    </div>
  );
};

const Step3 = ({ formData, setFormData, onNext, onBack }) => (
  <div className="space-y-6 animate-in fade-in duration-500 pb-10 font-black font-black font-black font-black font-black font-black">
    <div className="bg-white p-6 md:p-8 rounded-[2.5rem] shadow-xl shadow-stone-200 border border-stone-100 space-y-12 text-left font-black font-black font-black font-black font-black font-black">
      <h2 className="text-xl font-black text-[#73634a] flex items-center justify-center md:justify-start gap-2 px-1 text-center md:text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black"><PawPrint size={24} /> 習慣與飲食偏好</h2>
      
      <div className="bg-amber-50/60 border border-amber-100 p-6 rounded-[2.5rem] space-y-3 shadow-sm mx-1 text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
        <div className="flex items-center gap-2 text-[#8c7851] font-black text-xs uppercase tracking-[0.2em] font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
          <Utensils size={16} /> 飲食特別須知
        </div>
        <p className="text-[11px] text-stone-600 font-bold leading-relaxed text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
          入住請準備貓咪<span className="text-[#73634a] underline decoration-[#8c7851]/30 underline-offset-4 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">習慣吃的食物</span>。貓咪是高敏感動物，自備熟悉食物可避免因環境更動導致的不適或腹瀉。
          <span className="block mt-3 py-2 px-3 bg-white/50 rounded-xl text-[#8c7851] font-black border border-[#8c7851]/10 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">※ 若無法自行準備，本館提供頂級乾飼料與生食可加購。</span>
        </p>
      </div>

      <div className="space-y-4 px-1 text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
        <label className="text-[10px] font-black text-stone-400 px-1 uppercase tracking-widest text-center block font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">Litter Preference</label>
        <div className="grid grid-cols-2 gap-4 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
          {['礦砂', '豆腐砂', '木屑砂', '木薯砂'].map(i => (
            <button key={i} onClick={() => setFormData({...formData, litterType: i})} className={`p-5 rounded-3xl border-2 text-sm font-black transition-all duration-300 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black ${formData.litterType === i ? 'bg-[#8c7851] text-white border-[#8c7851] shadow-md translate-y-[-2px]' : 'bg-stone-50 text-stone-500 border-stone-50 hover:border-stone-200'}`}>{i}</button>
          ))}
        </div>
      </div>

      <div className="space-y-4 px-1 text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
        <label className="text-[10px] font-black text-stone-400 px-1 uppercase tracking-widest text-center block font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">Feeding Method</label>
        <div className="grid grid-cols-3 gap-3 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
          {['乾飼料', '罐頭', '生食'].map(i => (
            <button key={i} onClick={() => setFormData({...formData, feedingMethod: i})} className={`p-5 rounded-3xl border-2 text-sm font-black transition-all duration-300 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black ${formData.feedingMethod === i ? 'bg-[#73634a] text-white border-[#73634a] shadow-md translate-y-[-2px]' : 'bg-stone-50 text-stone-500 border-stone-50 hover:border-stone-200'}`}>{i}</button>
          ))}
        </div>
      </div>

      <div className="pt-8 border-t border-stone-50 space-y-6 px-1 text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
        <h3 className="text-xs font-black text-[#73634a] uppercase tracking-widest flex items-center justify-center md:justify-start gap-2 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black"><ShoppingBag size={14} /> 館內鮮食加購</h3>
        <div className="space-y-4 text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
          {[
            { id: 'dryFood', label: '頂級乾飼料 (早晚各一餐)', price: 60, unit: '天' },
            { id: 'rawChicken', label: '舒肥雞肉 (100g)', price: 70, unit: '餐' },
            { id: 'rawBeef', label: '精選生牛肉 (100g)', price: 85, unit: '餐' },
          ].map(f => (
            <div key={f.id} className="flex items-center justify-between p-5 rounded-[2rem] border border-stone-100 bg-stone-50/50 hover:bg-stone-50 transition-all text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
              <div className="space-y-0.5 text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
                <p className="font-black text-sm text-stone-700 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">{f.label}</p>
                <p className="text-[10px] text-[#8c7851] font-black italic font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">${f.price} / {f.unit}</p>
              </div>
              <input type="number" min="0" className="w-16 p-3 text-center border-2 border-stone-100 rounded-2xl bg-white font-black text-sm outline-none focus:border-[#8c7851] transition-all font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black" value={formData.addOnFood[f.id]} onChange={e => setFormData({...formData, addOnFood: {...formData.addOnFood, [f.id]: parseInt(e.target.value) || 0}})} />
            </div>
          ))}
        </div>
      </div>
    </div>
    <div className="flex gap-4 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
      <button onClick={onBack} className="flex-1 py-5 bg-white text-stone-400 rounded-3xl font-black border border-stone-100 transition-all hover:bg-stone-50 active:scale-95 font-black font-black">返回</button>
      <button onClick={onNext} className="flex-[2.5] py-5 bg-[#73634a] text-white rounded-3xl font-black shadow-xl hover:bg-[#5d503c] transition-all active:scale-95 flex items-center justify-center gap-2 font-black font-black font-black font-black font-black">下一步 <ChevronRight size={20} /></button>
    </div>
  </div>
);

const Step4 = ({ formData, setFormData, onNext, onBack }) => (
  <div className="space-y-6 animate-in fade-in duration-500 pb-10 font-black font-black font-black font-black font-black font-black font-black font-black">
    <div className="bg-white p-6 md:p-8 rounded-[2.5rem] shadow-xl shadow-stone-200 border border-stone-100 space-y-10 text-left font-black font-black font-black font-black font-black font-black font-black font-black">
      <h2 className="text-xl font-black text-[#73634a] flex items-center justify-center md:justify-start gap-2 px-1 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black"><Clock size={24} /> 預約入住時程</h2>
      <div className="space-y-10 px-1 text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
        <div className="space-y-4 text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
          <p className="text-[10px] font-black text-[#8c7851] uppercase tracking-[0.4em] px-1 text-center md:text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">Check-In 入住房間</p>
          <div className="grid grid-cols-2 gap-4 text-center md:text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
            <input type="date" className="w-full p-4 rounded-2xl border-2 border-stone-100 bg-stone-50 font-bold text-sm outline-none focus:bg-white focus:border-[#8c7851] transition-all text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black" value={formData.checkInDate} onChange={e => setFormData({...formData, checkInDate: e.target.value})} />
            <select className="w-full p-4 rounded-2xl border border-stone-100 bg-stone-50 font-bold text-sm appearance-none outline-none focus:bg-white focus:border-[#8c7851] transition-all text-center md:text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black" value={formData.checkInTime} onChange={e => setFormData({...formData, checkInTime: e.target.value})}>
              {[11, 12, 13, 14, 15, 16, 17, 18].map(h => <option key={h} value={`${h}:00`}>{h}:00</option>)}
            </select>
          </div>
        </div>
        <div className="space-y-4 pt-10 border-t border-stone-50 text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
          <p className="text-[10px] font-black text-stone-300 uppercase tracking-[0.4em] px-1 text-center md:text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">Check-Out 辦理退宿</p>
          <div className="grid grid-cols-2 gap-4 text-center md:text-left text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
            <input type="date" className="w-full p-4 rounded-2xl border-2 border-stone-100 bg-stone-50 font-bold text-sm outline-none focus:bg-white focus:border-[#8c7851] transition-all text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black" value={formData.checkOutDate} onChange={e => setFormData({...formData, checkOutDate: e.target.value})} />
            <select className="w-full p-4 rounded-2xl border border-stone-100 bg-stone-50 font-bold text-sm appearance-none outline-none focus:bg-white focus:border-[#8c7851] transition-all text-center md:text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black" value={formData.checkOutTime} onChange={e => setFormData({...formData, checkOutTime: e.target.value})}>
              {[11, 12, 13, 14, 15, 16, 17, 18].map(h => <option key={h} value={`${h}:00`}>{h}:00</option>)}
            </select>
          </div>
        </div>
      </div>

      {/* --- TP-Link Tapo 監視器說明 (優化縮小版) --- */}
      <div className="bg-sky-50 border border-sky-100 p-6 rounded-[2.5rem] space-y-6 mx-1 shadow-sm font-black font-black font-black font-black font-black overflow-hidden relative font-black font-black font-black font-black">
         <div className="flex items-center gap-3 text-sky-800 font-black text-xs uppercase tracking-widest relative z-10 font-black font-black font-black font-black font-black font-black font-black font-black">
            <Video size={18} className="text-sky-600 font-black" /> 24H 房間監控服務
         </div>
         
         <div className="relative max-w-[180px] mx-auto group font-black font-black font-black font-black">
            <div className="bg-stone-900 p-1.5 rounded-[2.25rem] shadow-2xl border-4 border-stone-800 relative z-10 font-black font-black font-black font-black">
               <div className="bg-stone-100 rounded-[1.8rem] overflow-hidden aspect-[9/16] relative flex flex-col font-black font-black font-black font-black">
                  <div className="relative w-full aspect-video bg-stone-800 flex items-center justify-center group-hover:bg-stone-700 transition-colors font-black font-black font-black font-black">
                     <div className="absolute top-1.5 left-1.5 flex items-center gap-1 px-1.5 py-0.5 bg-red-600 rounded-full font-black">
                        <div className="w-0.5 h-0.5 bg-white rounded-full animate-pulse font-black font-black" />
                        <span className="text-[6px] text-white font-black tracking-tighter">LIVE</span>
                     </div>
                     <div className="absolute top-1.5 right-1.5 text-[6px] text-white/50 font-black uppercase font-black font-black font-black">Room 02</div>
                     <Video size={24} className="text-stone-600 group-hover:text-stone-400 transition-all duration-700 font-black font-black font-black" />
                     <div className="absolute bottom-1.5 right-1.5 font-black font-black font-black font-black font-black font-black font-black"><Maximize size={10} className="text-white/30 font-black font-black font-black" /></div>
                  </div>
                  
                  <div className="flex-1 bg-white p-3 space-y-3 font-black font-black font-black font-black">
                     <div className="grid grid-cols-4 gap-1.5 font-black font-black font-black font-black font-black">
                        {[Camera, Video, Mic, Radio].map((Icon, i) => (
                           <div key={i} className="aspect-square bg-stone-50 rounded-lg flex items-center justify-center text-stone-300 font-black font-black font-black font-black font-black font-black">
                              <Icon size={12} />
                           </div>
                        ))}
                     </div>
                     <div className="h-1.5 w-full bg-stone-100 rounded-full overflow-hidden font-black font-black font-black font-black font-black">
                        <div className="h-full w-1/3 bg-sky-400 rounded-full font-black font-black font-black font-black" />
                     </div>
                     <div className="space-y-1.5 pt-1.5 font-black font-black font-black font-black font-black font-black">
                        <div className="h-1 w-2/3 bg-stone-50 rounded-full font-black font-black font-black font-black font-black font-black" />
                        <div className="h-1 w-1/2 bg-stone-50 rounded-full font-black font-black font-black font-black font-black font-black font-black" />
                     </div>
                  </div>
                  <div className="absolute bottom-3 left-1/2 -translate-x-1/2 flex flex-col items-center opacity-20 font-black font-black font-black font-black font-black">
                     <span className="text-[6px] font-black tracking-widest text-stone-400 uppercase font-black font-black font-black font-black">TP-Link Tapo</span>
                  </div>
               </div>
            </div>
            <div className="absolute inset-0 bg-sky-200/50 blur-3xl -z-10 translate-y-4 scale-90 font-black font-black font-black" />
         </div>

         <div className="space-y-4 relative z-10 pt-2 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
            <p className="text-[13px] text-sky-900 font-black leading-relaxed flex items-start gap-3 font-black font-black font-black font-black font-black">
               <ShieldCheck size={16} className="text-sky-500 mt-0.5 flex-shrink-0 font-black font-black font-black" />
               <span>所有貓房間皆提供 <span className="text-sky-600 font-black font-black font-black font-black">24小時</span> 監視器</span>
            </p>
            <div className="p-4 bg-white/60 rounded-3xl border border-sky-100/50 space-y-3 font-black font-black font-black font-black font-black font-black font-black font-black font-black">
               <p className="text-[12px] text-sky-800 font-black leading-relaxed flex items-start gap-3 font-black font-black font-black font-black font-black font-black font-black">
                  <Smartphone size={16} className="text-sky-500 mt-0.5 flex-shrink-0 font-black font-black font-black font-black font-black font-black" />
                  <span>入住前可以先下載 <span className="text-sky-600 underline decoration-sky-200 underline-offset-4 font-black font-black font-black font-black">TP-Link Tapo</span> 並註冊完畢</span>
               </p>
               <p className="text-[12px] text-sky-800 font-black leading-relaxed flex items-start gap-3 font-black font-black font-black font-black font-black font-black font-black font-black font-black">
                  <Radio size={16} className="text-sky-500 mt-0.5 flex-shrink-0 font-black font-black font-black font-black font-black font-black font-black" />
                  <span>當天即可立即分享住宿畫面</span>
               </p>
            </div>
         </div>
      </div>

      <div className="bg-rose-50 border border-rose-100 p-6 rounded-[2.5rem] space-y-3 shadow-sm mx-1 text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black">
        <div className="flex items-center gap-2 text-rose-800 font-black text-xs uppercase tracking-widest text-left font-black font-black font-black font-black font-black font-black font-black font-black">
          <AlertCircle size={16} /> 入住與退宿重要提醒
        </div>
        <p className="text-[11px] text-stone-600 font-bold leading-relaxed text-left font-black font-black font-black font-black font-black font-black font-black font-black">
          入住與退宿時間請務必準確預約。由於本館採預約制，若<span className="text-rose-700 underline underline-offset-4 decoration-rose-300 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">臨時提前或延後抵達</span>，可能因館內正進行美容服務而無法即時為您開門接待，請務必準時抵達或提前透過 LINE 告知。
        </p>
      </div>
    </div>
    <div className="flex gap-4 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
      <button onClick={onBack} className="flex-1 py-5 bg-white text-stone-400 rounded-3xl font-black border border-stone-100 transition-all hover:bg-stone-50 active:scale-95 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">返回</button>
      <button onClick={onNext} className="flex-[2.5] py-5 bg-[#73634a] text-white rounded-3xl font-black shadow-xl hover:bg-[#5d503c] transition-all active:scale-95 flex items-center justify-center gap-2 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">生成預約單 <ChevronRight size={20} /></button>
    </div>
  </div>
);

const Step5 = ({ formData, calculateTotal, onBack, copyFeedback, onSendLine }) => {
  const summary = `【Fluffy Moko∥這裡有貓 住宿預約單】\n家長姓名：${formData.parentName}\n貓咪姓名：${formData.catName}\n聯絡電話：${formData.phone}\n入住房型：${formData.roomType === 'vip' ? 'VIP旗艦房' : 'Standard普通房'} (${formData.isHoliday ? '國定連假價' : '一般平日價'})\n入住貓數：${formData.extraCats + 1} 隻\n習慣砂/食：${formData.litterType} / ${formData.feedingMethod}\n加購內容：乾糧 ${formData.addOnFood.dryFood}天、雞肉 ${formData.addOnFood.rawChicken}餐、牛肉 ${formData.addOnFood.rawBeef}餐\n貓咪備註：${formData.catRemarks || '無'}\n入住日期：${formData.checkInDate} ${formData.checkInTime}\n退宿日期：${formData.checkOutDate} ${formData.checkOutTime}\n預計總金額：$${calculateTotal}`.trim();

  return (
    <div className="space-y-6 animate-in fade-in duration-500 pb-10 font-black font-black font-black font-black font-black font-black font-black font-black font-black">
      <div className="bg-white rounded-[3rem] shadow-2xl border border-stone-100 overflow-hidden font-black font-black font-black font-black font-black font-black font-black font-black">
        <div className="bg-[#73634a] p-8 text-white text-center relative font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
          <h2 className="text-xl font-black flex items-center justify-center gap-3 font-black font-black font-black font-black font-black font-black font-black font-black font-black">
             <ClipboardCheck size={24} /> 預約明細確認
          </h2>
          <p className="text-[10px] font-black uppercase tracking-[0.4em] opacity-40 mt-1 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">Final Booking Summary</p>
        </div>
        
        <div className="p-6 space-y-6 font-black font-black font-black font-black font-black font-black font-black font-black">
          <div className="bg-amber-50 border border-amber-200 p-5 rounded-[2.5rem] space-y-3 text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black">
            <div className="flex items-center gap-2 text-amber-800 font-black text-sm uppercase tracking-widest justify-center md:justify-start font-black font-black font-black font-black font-black font-black font-black font-black font-black">
               <Send size={16} /> 預約最後步驟
            </div>
            <div className="text-[12px] text-amber-700 font-bold leading-relaxed text-center md:text-left text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
              預約尚未完成！請點擊下方按鈕將明細「傳送至官方 LINE」，<strong className="text-amber-900 underline underline-offset-4 decoration-amber-900/30 font-black text-center block md:inline font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">待店家回覆確認後，才算預約完成。</strong>
            </div>
          </div>

          <div className="bg-[#73634a] rounded-[1.5rem] p-4 text-white shadow-md relative overflow-hidden flex items-center justify-center gap-4 w-full group font-black font-black font-black font-black font-black font-black font-black">
             <div className="opacity-10 rotate-12 transition-transform group-hover:rotate-0 font-black font-black font-black font-black font-black font-black font-black font-black"><Receipt size={32} /></div>
             <div className="flex flex-col items-center font-black font-black font-black font-black font-black font-black">
                <span className="text-[7px] font-black tracking-[0.2em] uppercase opacity-50 mb-1 font-black font-black font-black font-black font-black font-black">Total Estimated Amount</span>
                <div className="flex items-end gap-1 leading-none font-black font-black font-black font-black font-black font-black font-black font-black font-black">
                   <span className="text-xs font-bold opacity-80 mb-0.5 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">$</span>
                   <span className="text-3xl font-black tracking-tighter font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">{calculateTotal}</span>
                </div>
             </div>
          </div>

          <div className="bg-stone-50/80 p-6 rounded-[2.5rem] border-2 border-dashed border-stone-200 relative shadow-inner text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black">
            <div className="flex items-center justify-between mb-4 border-b border-stone-200/60 pb-3 text-left font-black font-black font-black font-black font-black font-black font-black font-black">
               <span className="text-[10px] font-black text-stone-400 uppercase tracking-widest font-black font-black font-black font-black font-black font-black font-black font-black">發送內容預覽</span>
               <Copy size={14} className="text-stone-300 font-black font-black font-black font-black font-black font-black font-black font-black font-black" />
            </div>
            <div className="text-[13px] text-stone-700 whitespace-pre-line font-mono leading-relaxed overflow-x-hidden text-left font-black font-black font-black font-black font-black font-black">
              {summary}
            </div>
            {copyFeedback && (
              <div className="absolute inset-0 bg-white/95 flex flex-col items-center justify-center rounded-[2.5rem] animate-in fade-in duration-300 backdrop-blur-sm text-center font-black font-black font-black font-black font-black font-black font-black font-black">
                 <CheckCircle2 className="text-green-500 mb-2 font-black font-black font-black font-black font-black font-black" size={40} />
                 <span className="text-sm font-black text-stone-800 tracking-widest font-black text-center font-black font-black font-black font-black font-black font-black font-black font-black font-black">內容已自動複製！</span>
              </div>
            )}
          </div>

          <div className="flex items-center gap-4 p-5 bg-[#8c7851]/5 rounded-[2rem] border border-[#8c7851]/10 text-left font-black font-black font-black font-black font-black font-black font-black font-black">
            <div className="w-10 h-10 bg-[#8c7851] rounded-2xl flex items-center justify-center text-white flex-shrink-0 shadow-lg shadow-[#8c7851]/20 font-black font-black font-black font-black font-black font-black font-black">
              <MessageCircle size={20} />
            </div>
            <p className="text-[11px] text-[#8c7851] font-bold leading-snug text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
              點擊下方按鈕將開啟 LINE 並自動帶入明細文字至輸入框。
            </p>
          </div>
        </div>
      </div>

      <div className="flex flex-col gap-4 font-black font-black font-black font-black font-black font-black font-black font-black">
        <button onClick={() => onSendLine(summary)} className="w-full py-6 bg-[#06C755] text-white rounded-3xl font-black shadow-xl flex items-center justify-center gap-3 active:scale-95 group shadow-green-200 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black"><MessageCircle size={24} className="group-hover:rotate-12 transition-transform font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black" /> 複製預約單並傳送到 LINE</button>
        <button onClick={onBack} className="w-full py-5 bg-white text-stone-400 rounded-3xl font-black border border-stone-100 active:scale-95 font-black transition-all font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">返回修改內容</button>
      </div>
    </div>
  );
};

// --- 主組件 App ---

const App = () => {
  const [step, setStep] = useState(1);
  const [copyFeedback, setCopyFeedback] = useState(false);
  const [formData, setFormData] = useState({
    parentName: '',
    phone: '',
    catName: '',
    catRemarks: '', 
    roomType: 'standard',
    isHoliday: false,
    extraCats: 0,
    litterType: '礦砂',
    feedingMethod: '乾飼料',
    addOnFood: {
      dryFood: 0,
      rawChicken: 0,
      rawBeef: 0,
    },
    checkInDate: '',
    checkInTime: '13:00',
    checkOutDate: '',
    checkOutTime: '13:00',
  });

  const calculateTotal = useMemo(() => {
    const roomBase = formData.isHoliday 
      ? pricing[formData.roomType].holiday 
      : pricing[formData.roomType].normal;
    
    const extraCatCost = formData.extraCats * pricing.extraCat;
    const foodCost = (formData.addOnFood.dryFood * pricing.food.dryFood) +
                     (formData.addOnFood.rawChicken * pricing.food.rawChicken) +
                     (formData.addOnFood.rawBeef * pricing.food.rawBeef);

    return roomBase + extraCatCost + foodCost;
  }, [formData.roomType, formData.isHoliday, formData.extraCats, formData.addOnFood]);

  const handleNext = useCallback(() => {
    window.scrollTo({ top: 0, behavior: 'smooth' });
    setStep(s => Math.min(s + 1, 5));
  }, []);

  const handleBack = useCallback(() => {
    window.scrollTo({ top: 0, behavior: 'smooth' });
    setStep(s => Math.max(s - 1, 1));
  }, []);

  const loadMockHistory = useCallback(() => {
    setFormData(prev => ({
      ...prev,
      parentName: '回訪家長',
      phone: '09xxxxxxxx',
      catName: 'Moko',
      catRemarks: '個性溫和，容易緊張',
      litterType: '豆腐砂',
      feedingMethod: '罐頭'
    }));
  }, []);

  const handleSendLine = useCallback((summary) => {
    const el = document.createElement('textarea'); 
    el.value = summary; 
    document.body.appendChild(el); 
    el.select(); 
    document.execCommand('copy'); 
    document.body.removeChild(el); 
    setCopyFeedback(true);
    setTimeout(() => { 
      setCopyFeedback(false); 
      window.open(`https://line.me/R/oaMessage/@051yzbua/?${encodeURIComponent(summary)}`, '_blank'); 
    }, 800);
  }, []);

  return (
    <div className="min-h-screen bg-[#fcfaf7] font-sans text-stone-800 pb-20 selection:bg-[#8c7851]/20 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
      <header className="bg-white/80 backdrop-blur-xl border-b border-stone-100 p-5 sticky top-0 z-50 shadow-sm overflow-hidden text-center text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
        <div className="absolute top-0 left-0 w-full h-[3px] bg-gradient-to-r from-[#73634a] to-[#8c7851]" />
        <h1 className="text-xl font-black text-[#73634a] tracking-tighter transition-all font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">Fluffy Moko∥這裡有貓</h1>
        <p className="text-[10px] text-stone-400 font-black tracking-widest mt-0.5 uppercase opacity-60 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">Where comfort meets quiet.</p>
      </header>

      <main className="max-w-md mx-auto px-6 pt-10 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
        <div className="flex justify-between mb-12 relative px-4 text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
          {[1, 2, 3, 4, 5].map(i => (
            <div key={i} className="flex flex-col items-center z-10 text-left font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
              <div className={`w-10 h-10 rounded-2xl flex items-center justify-center text-[10px] font-black border-2 transition-all duration-700 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black ${step === i ? 'bg-[#73634a] text-white border-[#73634a] scale-125 shadow-xl shadow-[#73634a]/30 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black' : step > i ? 'bg-[#8c7851] text-white border-[#8c7851] font-black font-black font-black font-black font-black font-black font-black' : 'bg-white text-stone-200 border-stone-100 font-black font-black font-black font-black font-black font-black font-black'}`}>{step > i ? <CheckCircle2 size={16} /> : `0${i}`}</div>
            </div>
          ))}
          <div className="absolute top-5 left-8 right-8 h-0.5 bg-stone-100 -z-10 rounded-full font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black" />
          <div className="absolute top-5 left-8 h-0.5 bg-[#8c7851] -z-10 transition-all duration-700 rounded-full font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black" style={{ width: `${(step - 1) * 22.5}%` }} />
        </div>

        {step === 1 && <Step1 onNext={handleNext} />}
        {step === 2 && <Step2 formData={formData} setFormData={setFormData} onNext={handleNext} onBack={handleBack} calculateTotal={calculateTotal} loadMockHistory={loadMockHistory} />}
        {step === 3 && <Step3 formData={formData} setFormData={setFormData} onNext={handleNext} onBack={handleBack} />}
        {step === 4 && <Step4 formData={formData} setFormData={setFormData} onNext={handleNext} onBack={handleBack} />}
        {step === 5 && <Step5 formData={formData} calculateTotal={calculateTotal} onBack={handleBack} copyFeedback={copyFeedback} onSendLine={handleSendLine} />}
        
        <footer className="mt-12 p-6 bg-white rounded-[2rem] shadow-xl text-center space-y-4 border border-stone-100 relative overflow-hidden shadow-stone-200/40 transition-all text-center font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
          <div className="space-y-1.5 text-center font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
            <p className="text-[#73634a] font-black text-[15px] tracking-tight font-black font-black font-black font-black font-black font-black font-black font-black text-center font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">{shopInfo.name}</p>
            <div className="inline-flex items-center justify-center gap-2 bg-stone-50 px-4 py-1.5 rounded-full border border-stone-200/50 mx-auto text-center font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
              <Clock size={13} className="text-[#8c7851] font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black" />
              <p className="text-[#8c7851] text-[11px] font-black uppercase tracking-widest leading-none font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">{shopInfo.hours}</p>
            </div>
            <p className="text-[11px] text-stone-500 font-bold tracking-tight block font-bold text-center font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">{shopInfo.notice}</p>
          </div>
          <div className="space-y-3 text-stone-600 text-[11px] font-medium max-w-[240px] mx-auto border-t border-stone-50 pt-5 text-center font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
            <div className="flex flex-col gap-1.5 text-center font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
              <p className="font-black flex items-center justify-center gap-2 text-[#73634a] text-xs font-black text-center font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
                <Phone size={13} className="text-[#8c7851] font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black" />{shopInfo.phone}
              </p>
              <p className="flex items-center justify-center gap-2 text-stone-500 font-bold text-xs font-bold text-center font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
                <MapPin size={13} className="text-stone-400 font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black" />{shopInfo.address}
              </p>
            </div>
            <p className="pt-1.5 text-[10px] font-black text-stone-300 uppercase tracking-widest leading-none font-black text-center font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">
              {shopInfo.permit}
            </p>
          </div>
          <p className="text-stone-300 font-black tracking-[0.4em] uppercase text-[8px] opacity-60 pt-2 font-black text-center font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black font-black">© 2026 Fluffy Moko</p>
        </footer>
      </main>
    </div>
  );
};

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<App />);
</script>
</body>
</html>